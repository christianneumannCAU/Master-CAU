hist(rg_tab$AP_EXPONENT)
qqnorm(rg_tab$AP_EXPONENT)
qqline(rg_tab$AP_EXPONENT)
shapiro.test(rg_tab$AP_EXPONENT)
hist(rg_tab$THETA_POWER)
qqnorm(rg_tab$THETA_POWER)
qqline(rg_tab$THETA_POWER)
shapiro.test(rg_tab$THETA_POWER)
hist(rg_tab$ALPHA_POWER)
qqnorm(rg_tab$ALPHA_POWER)
qqline(rg_tab$ALPHA_POWER)
shapiro.test(rg_tab$ALPHA_POWER)
hist(rg_tab$BETA_POWER)
qqnorm(rg_tab$BETA_POWER)
qqline(rg_tab$BETA_POWER)
shapiro.test(rg_tab$BETA_POWER)
## try z-transformation
for(i in 1:30) {
idx <-  rg_tab$ID == i
rg_tab$z_exp[idx] <- scale(rg_tab$AP_EXPONENT[idx])
rg_tab$z_theta[idx] <- scale(rg_tab$THETA_POWER[idx])
rg_tab$z_alpha[idx] <- scale(rg_tab$ALPHA_POWER[idx])
rg_tab$z_beta[idx] <- scale(rg_tab$BETA_POWER[idx])
}
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
shapiro.test(rg_tab$z_exp)
hist(rg_tab$z_theta)
qqnorm(rg_tab$z_theta)
qqline(rg_tab$z_theta)
shapiro.test(rg_tab$z_theta)
hist(rg_tab$z_alpha)
qqnorm(rg_tab$z_alpha)
qqline(rg_tab$z_alpha)
shapiro.test(rg_tab$z_alpha)
hist(rg_tab$z_beta)
qqnorm(rg_tab$z_beta)
qqline(rg_tab$z_beta)
shapiro.test(rg_tab$z_beta)
# try square-root
rg_tab$sq_exp <- sqrt(rg_tab$z_exp)
rg_tab$sq_theta <- sqrt(rg_tab$z_theta)
rg_tab$sq_alpha <- sqrt(rg_tab$z_alpha)
rg_tab$sq_beta <- sqrt(rg_tab$z_beta)
## visualizing log data
hist(rg_tab$log_exp)
## visualizing log data
hist(rg_tab$sq_exp)
qqnorm(rg_tab$lsq_exp)
qqline(rg_tab$sq_exp)
shapiro.test(sq$log_exp)
shapiro.test(rg_tab$sq_exp)
View(rg_tab)
min(rg_tab$z_exp)
min(rg_tab$z_alpha)
min(rg_tab$z_beta)
# try square-root
rg_tab$sq_exp <- sqrt(rg_tab$z_exp+5)
rg_tab$sq_theta <- sqrt(rg_tab$z_theta+5)
rg_tab$sq_alpha <- sqrt(rg_tab$z_alpha+5)
rg_tab$sq_beta <- sqrt(rg_tab$z_beta+5)
## visualizing log data
hist(rg_tab$sq_exp)
qqnorm(rg_tab$lsq_exp)
qqline(rg_tab$sq_exp)
qqnorm(rg_tab$lsq_exp)
qqnorm(rg_tab$sq_exp)
qqline(rg_tab$sq_exp)
## visualizing log data
hist(rg_tab$sq_exp)
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
shapiro.test(rg_tab$z_exp)
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
## visualizing z data
hist(rg_tab$z_exp)
## visualizing square-root data
hist(rg_tab$sq_exp)
qqnorm(rg_tab$sq_exp)
qqline(rg_tab$sq_exp)
hist(rg_tab$sq_theta)
hist(rg_tab$z_alpha)
rg_tab$sq_theta <- log10(rg_tab$z_theta+5)
hist(rg_tab$sq_theta)
qqnorm(rg_tab$sq_theta)
qqline(rg_tab$sq_theta)
## visualizing data
hist(rg_tab$AP_EXPONENT)
qqnorm(rg_tab$AP_EXPONENT)
qqline(rg_tab$AP_EXPONENT)
hist(rg_tab$THETA_POWER)
qqnorm(rg_tab$THETA_POWER)
qqline(rg_tab$THETA_POWER)
hist(rg_tab$ALPHA_POWER)
qqnorm(rg_tab$ALPHA_POWER)
qqline(rg_tab$ALPHA_POWER)
hist(rg_tab$BETA_POWER)
qqnorm(rg_tab$BETA_POWER)
qqline(rg_tab$BETA_POWER)
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
hist(rg_tab$z_theta)
qqnorm(rg_tab$z_theta)
qqline(rg_tab$z_theta)
hist(rg_tab$z_alpha)
qqnorm(rg_tab$z_alpha)
qqline(rg_tab$z_alpha)
hist(rg_tab$z_beta)
qqnorm(rg_tab$z_beta)
qqline(rg_tab$z_beta)
# try log-transformation exept ap_exp
rg_tab$sq_theta <- log10(rg_tab$z_theta+5)
rg_tab$sq_alpha <- sqrt(rg_tab$z_alpha+5)
rg_tab$sq_beta <- sqrt(rg_tab$z_beta+5)
# try log-transformation exept ap_exp
rg_tab$log_theta <- log10(rg_tab$z_theta+5)
rg_tab$log_alpha <- log10(rg_tab$z_alpha+5)
rg_tab$log_beta <- log10(rg_tab$z_beta+5)
## visualizing square-root data
hist(rg_tab$log_exp)
## visualizing log data
hist(rg_tab$log_theta)
qqnorm(rg_tab$log_theta)
qqline(rg_tab$log_theta)
shapiro.test(rg_tab$log_theta)
hist(rg_tab$log_alpha)
qqnorm(rg_tab$log_alpha)
qqline(rg_tab$log_alpha)
shapiro.test(rg_tab$log_alpha)
hist(rg_tab$log_beta)
qqnorm(rg_tab$log_beta)
qqline(rg_tab$log_beta)
shapiro.test(rg_tab$log_beta)
## visualizing log data
hist(rg_tab$log_theta)
# try log-transformation exept ap_exp
rg_tab$log_theta <- 1/(rg_tab$z_theta+5)
## visualizing log data
hist(rg_tab$log_theta)
qqnorm(rg_tab$log_theta)
qqline(rg_tab$log_theta)
## visualizing log data
hist(rg_tab$log_theta)
shapiro.test(rg_tab$log_theta)
hist(rg_tab$log_alpha)
qqnorm(rg_tab$log_alpha)
qqline(rg_tab$log_alpha)
shapiro.test(rg_tab$log_alpha)
hist(rg_tab$log_alpha)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha+5)
hist(rg_tab$log_alpha)
qqnorm(rg_tab$log_alpha)
qqline(rg_tab$log_alpha)
shapiro.test(rg_tab$log_alpha)
hist(rg_tab$log_beta)
qqnorm(rg_tab$log_beta)
qqline(rg_tab$log_beta)
shapiro.test(rg_tab$log_beta)
rg_tab$log_beta <- 1/(rg_tab$z_beta+5)
hist(rg_tab$log_beta)
qqnorm(rg_tab$log_beta)
qqline(rg_tab$log_beta)
shapiro.test(rg_tab$log_beta)
# try transforming exept ap_exp
rg_tab$log_theta <- 1/(rg_tab$z_theta)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha)
rg_tab$log_beta <- log10(rg_tab$z_beta)
## visualizing log data
hist(rg_tab$log_theta)
qqnorm(rg_tab$log_theta)
qqline(rg_tab$log_theta)
## visualizing z data
hist(rg_tab$z_exp)
hist(rg_tab$z_theta)
# try transforming exept ap_exp
rg_tab$log_theta <- 1/(rg_tab$z_theta)
## visualizing log data
hist(rg_tab$log_theta)
# try transforming exept ap_exp
rg_tab$log_theta <- log10(rg_tab$z_theta+5)
## visualizing log data
hist(rg_tab$log_theta)
qqnorm(rg_tab$log_theta)
qqline(rg_tab$log_theta)
shapiro.test(rg_tab$log_theta)
# try transforming exept ap_exp
rg_tab$log_theta <- 1/(rg_tab$z_theta+5)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha)
rg_tab$log_beta <- log10(rg_tab$z_beta)
## visualizing log data
hist(rg_tab$log_theta)
qqnorm(rg_tab$log_theta)
qqline(rg_tab$log_theta)
shapiro.test(rg_tab$log_theta)
## visualizing log data
hist(rg_tab$log_theta)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha)
hist(rg_tab$log_alpha)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha+5)
hist(rg_tab$log_alpha)
qqnorm(rg_tab$log_alpha)
qqline(rg_tab$log_alpha)
shapiro.test(rg_tab$log_alpha)
rg_tab$log_alpha <- log10/(rg_tab$z_alpha+5)
rg_tab$log_alpha <- log10/(rg_tab$z_alpha+5)
rg_tab$log_alpha <- log10(rg_tab$z_alpha+5)
hist(rg_tab$log_alpha)
qqnorm(rg_tab$log_alpha)
qqline(rg_tab$log_alpha)
shapiro.test(rg_tab$log_alpha)
rg_tab$log_alpha <- 1/(rg_tab$z_alpha+5)
rg_tab$log_beta <- log10(rg_tab$z_beta)
rg_tab$log_beta <- log10(rg_tab$z_beta+5)
hist(rg_tab$log_beta)
qqnorm(rg_tab$log_beta)
qqline(rg_tab$log_beta)
shapiro.test(rg_tab$log_beta)
# try transforming exept ap_exp
rg_tab$t_exp <- sqrt(max(rg_tab$z_exp+1) - rg_tab$z_exp)
## visualizing log data
hist(rg_tab$t_exp)
qqnorm(rg_tab$t_exp)
qqline(rg_tab$t_exp)
shapiro.test(rg_tab$t_exp)
## visualizing log data
hist(rg_tab$t_exp)
# try transforming exept ap_exp
rg_tab$t_exp <- log10(max(rg_tab$z_exp+1) - rg_tab$z_exp)
## visualizing log data
hist(rg_tab$t_exp)
qqnorm(rg_tab$t_exp)
qqline(rg_tab$t_exp)
shapiro.test(rg_tab$t_exp)
## visualizing log data
hist(rg_tab$t_exp)
# try transforming exept ap_exp
rg_tab$t_exp <- sqrt(max(rg_tab$z_exp+1) - rg_tab$z_exp)
## visualizing log data
hist(rg_tab$t_exp)
qqnorm(rg_tab$t_exp)
qqline(rg_tab$t_exp)
shapiro.test(rg_tab$t_exp)
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
shapiro.test(rg_tab$z_exp)
## visualizing log data
hist(rg_tab$t_exp)
## visualizing z data
hist(rg_tab$z_exp)
hist(rg_tab$DEPTH)
hist(rg_tab$distance)
## visualizing data
hist(rg_tab$AP_EXPONENT)
hist(rg_tab$THETA_POWER)
hist(rg_tab$ALPHA_POWER)
hist(rg_tab$BETA_POWER)
## visualizing z data
hist(rg_tab$z_exp)
hist(rg_tab$z_theta)
hist(rg_tab$z_alpha)
hist(rg_tab$z_beta)
## visualizing log data
hist(rg_tab$t_exp)
hist(rg_tab$t_theta)
hist(rg_tab$t_alpha)
## read data
rg_tab <- read.csv("C:/Users/acer/Desktop/Master CAU/02_data/04_final/regression_table.csv")
## Add new variable for distance to STN
rg_tab$distance <- abs(rg_tab$DEPTH)
## Test for normal distribution useless: gets significant automatically with big samplesize
shapiro.test(rg_tab$AP_EXPONENT)
## visualizing data
hist(rg_tab$AP_EXPONENT)
qqnorm(rg_tab$AP_EXPONENT)
qqline(rg_tab$AP_EXPONENT)
hist(rg_tab$THETA_POWER)
qqnorm(rg_tab$THETA_POWER)
qqline(rg_tab$THETA_POWER)
hist(rg_tab$ALPHA_POWER)
qqnorm(rg_tab$ALPHA_POWER)
qqline(rg_tab$ALPHA_POWER)
hist(rg_tab$BETA_POWER)
qqnorm(rg_tab$BETA_POWER)
qqline(rg_tab$BETA_POWER)
## try z-transformation
for(i in 1:30) {
idx <-  rg_tab$ID == i
rg_tab$z_exp[idx] <- scale(rg_tab$AP_EXPONENT[idx])
rg_tab$z_theta[idx] <- scale(rg_tab$THETA_POWER[idx])
rg_tab$z_alpha[idx] <- scale(rg_tab$ALPHA_POWER[idx])
rg_tab$z_beta[idx] <- scale(rg_tab$BETA_POWER[idx])
}
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
shapiro.test(rg_tab$z_exp)
hist(rg_tab$z_theta)
qqnorm(rg_tab$z_theta)
qqline(rg_tab$z_theta)
hist(rg_tab$z_alpha)
qqnorm(rg_tab$z_alpha)
qqline(rg_tab$z_alpha)
hist(rg_tab$z_beta)
qqnorm(rg_tab$z_beta)
qqline(rg_tab$z_beta)
# try transforming exept ap_exp
rg_tab$t_exp <- sqrt(max(rg_tab$z_exp+1) - rg_tab$z_exp) # square-root/ negatively skewed data
rg_tab$t_theta <- 1/(rg_tab$z_theta+5) # inverse/ positively skewed data
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+5) # inverse/ positively skewed data
rg_tab$t_beta <- log10(rg_tab$z_beta+5) # log/ positively skewed data
## visualizing log data
hist(rg_tab$t_exp)
qqnorm(rg_tab$t_exp)
qqline(rg_tab$t_exp)
shapiro.test(rg_tab$t_exp)
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
## read data
rg_tab <- read.csv("C:/Users/acer/Desktop/Master CAU/02_data/04_final/regression_table.csv")
## Add new variable for distance to STN
rg_tab$distance <- abs(rg_tab$DEPTH)
## Test for normal distribution useless: gets significant automatically with big samplesize
shapiro.test(rg_tab$AP_EXPONENT)
## visualizing data
hist(rg_tab$AP_EXPONENT)
## visualizing data
hist(rg_tab$AP_EXPONENT)
qqnorm(rg_tab$AP_EXPONENT)
qqline(rg_tab$AP_EXPONENT)
hist(rg_tab$THETA_POWER)
qqnorm(rg_tab$THETA_POWER)
qqline(rg_tab$THETA_POWER)
hist(rg_tab$ALPHA_POWER)
qqnorm(rg_tab$ALPHA_POWER)
qqline(rg_tab$ALPHA_POWER)
hist(rg_tab$BETA_POWER)
qqnorm(rg_tab$BETA_POWER)
qqline(rg_tab$BETA_POWER)
## try z-transformation
for(i in 1:30) {
idx <-  rg_tab$ID == i
rg_tab$z_exp[idx] <- scale(rg_tab$AP_EXPONENT[idx])
rg_tab$z_theta[idx] <- scale(rg_tab$THETA_POWER[idx])
rg_tab$z_alpha[idx] <- scale(rg_tab$ALPHA_POWER[idx])
rg_tab$z_beta[idx] <- scale(rg_tab$BETA_POWER[idx])
}
## visualizing z data
hist(rg_tab$z_exp)
qqnorm(rg_tab$z_exp)
qqline(rg_tab$z_exp)
shapiro.test(rg_tab$z_exp)
hist(rg_tab$z_theta)
qqnorm(rg_tab$z_theta)
qqline(rg_tab$z_theta)
hist(rg_tab$z_alpha)
qqnorm(rg_tab$z_alpha)
qqline(rg_tab$z_alpha)
hist(rg_tab$z_beta)
qqnorm(rg_tab$z_beta)
qqline(rg_tab$z_beta)
# try transforming exept ap_exp
rg_tab$t_exp <- sqrt(max(rg_tab$z_exp+1) - rg_tab$z_exp) # square-root/ negatively skewed data
rg_tab$t_theta <- 1/(rg_tab$z_theta+5) # inverse/ positively skewed data
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+5) # inverse/ positively skewed data
rg_tab$t_beta <- log10(rg_tab$z_beta+5) # log/ positively skewed data
## visualizing log data
hist(rg_tab$t_exp)
qqnorm(rg_tab$t_exp)
qqline(rg_tab$t_exp)
shapiro.test(rg_tab$t_exp)
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
min(rg_tab$z_theta)
min(rg_tab$z_alpha)
min(rg_tab$z_beta)
rg_tab$t_theta <- 1/(rg_tab$z_theta+3) # inverse/ positively skewed data
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+3) # inverse/ positively skewed data
rg_tab$t_beta <- log10(rg_tab$z_beta+3) # log/ positively skewed data
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+5) # inverse/ positively skewed data
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+4) # inverse/ positively skewed data
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+10) # inverse/ positively skewed data
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+6) # inverse/ positively skewed data
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
rg_tab$t_theta <- 1/(rg_tab$z_theta+3) # inverse/ positively skewed data
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
## visualizing log data
hist(rg_tab$t_exp)
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
rg_tab$t_theta <- 1/(rg_tab$z_theta+4) # inverse/ positively skewed data
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
rg_tab$t_theta <- 1/(rg_tab$z_theta+5) # inverse/ positively skewed data
hist(rg_tab$t_theta)
qqnorm(rg_tab$t_theta)
qqline(rg_tab$t_theta)
shapiro.test(rg_tab$t_theta)
rg_tab$t_beta <- log10(rg_tab$z_beta+3) # log/ positively skewed data
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+4) # log/ positively skewed data
shapiro.test(rg_tab$t_beta)
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+6) # log/ positively skewed data
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+4) # log/ positively skewed data
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+5) # log/ positively skewed data
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+3) # log/ positively skewed data
shapiro.test(rg_tab$t_beta)
rg_tab$t_beta <- log10(rg_tab$z_beta+4) # log/ positively skewed data
hist(rg_tab$t_beta)
qqnorm(rg_tab$t_beta)
qqline(rg_tab$t_beta)
shapiro.test(rg_tab$t_beta)
rg_tab$t_alpha <- 1/(rg_tab$z_alpha+6) # inverse/ positively skewed data
hist(rg_tab$t_alpha)
qqnorm(rg_tab$t_alpha)
qqline(rg_tab$t_alpha)
shapiro.test(rg_tab$t_alpha)
## Regression ##
norm_exp <- lme(fixed=DEPTH ~ AP_EXPONENT, random=~1|ID, data = rg_tab)
install.packages('lme4')
## Regression ##
norm_exp <- lme(fixed=DEPTH ~ AP_EXPONENT, random=~1|ID, data = rg_tab)
install.packages('nlme')
## Regression ##
norm_exp <- lme(fixed=DEPTH ~ AP_EXPONENT, random=~1|ID, data = rg_tab)
library(nlme)
## Regression ##
norm_exp <- lme(fixed=DEPTH ~ AP_EXPONENT, random=~1|ID, data = rg_tab)
summary(norm_exp)
anova(norm_exp)
z_exp <- lme(fixed=DEPTH ~ z_exp, random=~1|ID, data = rg_tab)
summary(z_exp)
anova(z_exp)
full_model <- lme(fixed=DEPTH ~ z_exp + z_theta + z_alpha + z_beta, random=~1|ID, data=rg_tab)
summary(full_model)
anova(full_model)
